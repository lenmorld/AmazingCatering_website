var fb_editor={dismissActiveTrigger:false,JSONParser:JSON||{},initEvents:function(){appVar.bringToFront();fb_container.init();fb_toolbox.init();fb_panel.init();fb_undo.init();if(appVar.platform()=="win"){$("#css_ui").attr("href","editordata/css/win_ui.css");$("#colorcss").attr("href","editordata/css/win_colorpicker.css");document.getElementsByTagName("body")[0].onselectstart=function(f){if(event.srcElement.tagName!="INPUT"&&event.srcElement.tagName!="TEXTAREA"){return false}};$("#elements").attr("hideFocus","hidefocus");$("#objectproperties").attr("hideFocus","hidefocus");$("#formproperties").attr("hideFocus","hidefocus")}else{$("#css_ui").attr("href","editordata/css/mac_ui.css");$("#colorcss").attr("href","editordata/css/mac_colorpicker.css")}$("#elements").click(function(){$(".current").removeClass("current");$("#tb_form_tools").addClass("current");$("#elements").addClass("current")});$("#objectproperties").click(function(){$(".current").removeClass("current");$("#tb_control_properties").addClass("current");$("#objectproperties").addClass("current");if(fb_container.itemSelected){fb_container.itemSelected.trigger("mousedown")}});$("#formproperties").click(function(){$(".current").removeClass("current");$("#tb_form_properties").addClass("current");$("#formproperties").addClass("current");fb_views.form()});$("#tb_form_tools").addClass("current");$("#elements").addClass("current");$("#tool_item_delete").click(function(){if(fb_editor.isSelectedItem()){fb_clipboard.doDelete()}else{appVar.displayAlert_("Please select an element to delete.")}});$("#tool_item_duplicate").click(function(){if(fb_editor.isSelectedItem()){var e=fb_clipboard.doCopy();fb_clipboard.doPaste(e)}else{appVar.displayAlert_("Please select an element to duplicate.")}});$(".fb-item, #fb-form-header1, #fb-submit-button-div").live("dblclick",function(){$("#objectproperties").trigger("click");setTimeout(function(){$("#control_properties_set input, #control_properties_set textarea").first().focus()},50);fb_panel.resetCursorPosition($("#control_properties_set input, #control_properties_set textarea").first().get(0),100);return false});$("#docContainer").live("dblclick",function(){$("#formproperties").trigger("click");return false});$("#docContainer").click(function(e){if($(e.srcElement).parent().get(0).id=="fb-captcha_control"||e.srcElement.id=="fb-captcha_control"){return}if(fb_container.itemSelected){fb_container.itemSelected.trigger("mousedown")}});$("body").keydown(function(i){if(i.keyCode=="37"&&fb_container.itemSelected&&!$(i.srcElement).is("input, textarea, select")){if(fb_container.itemSelected.is("#fb-submit-button-div")){if($(".fb-item").size()==0){$("#fb-form-header1").trigger("mousedown")}else{$(".fb-item").last().trigger("mousedown")}}else{var h=fb_container.itemSelected[0].previousSibling;if(h){$(h).trigger("mousedown")}else{$("#fb-form-header1").trigger("mousedown")}}return false}if(i.keyCode=="38"&&fb_container.itemSelected&&!$(i.srcElement).is("input, textarea, select")){if(fb_container.itemSelected.is("#fb-submit-button-div")){if($(".fb-item").size()==0){$("#fb-form-header1").trigger("mousedown")}else{$(".fb-item").last().trigger("mousedown")}}else{var e=fb_container.itemSelected[0].previousSibling;if(e){var l=fb_container.itemSelected[0].offsetTop;var g=fb_container.itemSelected[0].offsetLeft;var k=false;while(e){if((e.offsetTop<l)&&(g>=e.offsetLeft)){if(g==e.offsetLeft){$(e).trigger("mousedown");k=true;break}else{if(e.previousSibling&&(e.previousSibling.offsetLeft<g)&&(e.offsetTop==e.previousSibling.offsetTop)){$(e).trigger("mousedown");k=true;break}else{if((e.previousSibling&&(e.offsetTop!=e.previousSibling.offsetTop))||(!e.previousSibling)){$(e).trigger("mousedown");k=true;break}}e=e.previousSibling}}else{e=e.previousSibling}}if(k==false){$("#fb-form-header1").trigger("mousedown")}}else{$("#fb-form-header1").trigger("mousedown")}}return false}if(i.keyCode=="39"&&fb_container.itemSelected&&!$(i.srcElement).is("input, textarea, select")){if(fb_container.itemSelected.is("#fb-form-header1")){if($(".fb-item").size()==0){$("#fb-submit-button-div").trigger("mousedown")}else{$(".fb-item").first().trigger("mousedown")}}else{var j=fb_container.itemSelected[0].nextSibling;if(j){$(j).trigger("mousedown")}else{$("#fb-submit-button-div").trigger("mousedown")}}return false}if(i.keyCode=="40"&&fb_container.itemSelected&&!$(i.srcElement).is("input, textarea, select")){if(fb_container.itemSelected.is("#fb-form-header1")){if($(".fb-item").size()==0){$("#fb-submit-button-div").trigger("mousedown")}else{$(".fb-item").first().trigger("mousedown")}}else{var f=fb_container.itemSelected[0].nextSibling;if(f){var l=fb_container.itemSelected[0].offsetTop;var g=fb_container.itemSelected[0].offsetLeft;var k=false;while(f){if((f.offsetTop>l)&&(g>=f.offsetLeft)){if(g==f.offsetLeft){$(f).trigger("mousedown");k=true;break}else{if(f.nextSibling&&(f.nextSibling.offsetLeft>g)&&(f.offsetTop==f.nextSibling.offsetTop)){$(f).trigger("mousedown");k=true;break}else{if((f.nextSibling&&(f.offsetTop!=f.nextSibling.offsetTop))||(!f.nextSibling)){$(f).trigger("mousedown");k=true;break}}f=f.nextSibling}}else{f=f.nextSibling}}if(k==false){$("#fb-submit-button-div").trigger("mousedown")}}else{$("#fb-submit-button-div").trigger("mousedown")}}return false}});$("body").keyup(function(e){if(e.keyCode=="46"){fb_clipboard.doDelete()}});$("#fb-captcha_control").dblclick(function(){$("#formproperties").trigger("click");return false});$("#fb-submit-button").click(function(){return false});var d=0;var b=0;if(appVar.platform=="win"){d=13;b=26}else{d=12;b=12}$(window).resize(function(){$("#layout-center").width($(document).width()-332);$("#controlset").height($(document).height()-$("#control_toolbar").outerHeight()-d)});$(window).trigger("resize");var c="placeholder" in document.createElement("input");var a="placeholder" in document.createElement("textarea");if(!c){$("#docContainer input[type=text], #docContainer input[type=email], #docContainer input[type=url], #docContainer input[type=tel]").placeholder();if(appVar.platform()!="win"){$("#docContainer input[type=password]").placeholder()}}if(!a){$("#docContainer textarea").placeholder()}$("#fb-submit-button-div, #fb-form-header1").live("resize",function(){var e=$(this).children(0).attr("data-valign");if(e!="top"&&e!="middle"&&e!="bottom"){e="top"}if(e=="top"){$(this).children(0).css("margin-top","")}else{if(e=="middle"){$(this).children(0).css("margin-top",parseInt(parseInt($(this).height())/2-parseInt($(this).children(0).outerHeight())/2)+"px")}else{if(e=="bottom"){$(this).children(0).css("margin-top",parseInt($(this).height())-parseInt($(this).children(0).outerHeight())+"px")}}}});if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}},initSectionChildren:function(d){for(var c=0;c<d.length;c++){if($(d[c]).hasClass("column")){$(d[c]).sortable(fb_container.sortableProps);var b=$(d[c]).children();for(var a=0;a<b.length;a++){$(b[a]).mousedown(fb_editor.itemToSelectable)}}}fb_editor.notBackgroundActive();$("#docContainer a").live("click",function(e){e.preventDefault();return false});$("#fb-submit-button-div").mousedown(fb_editor.itemToSelectable);$("#fb-form-header1").mousedown(fb_editor.itemToSelectable)},backgroundActive:function(){if($(".column").hasClass("img_background")){$(".column").removeClass("img_background");$(".column").sortable("option","placeholder","ui-placeholder-bis")}},notBackgroundActive:function(){if(!$(".column").hasClass("img_background")){$(".column").sortable("option","placeholder","ui-placeholder-bis")}},triggerActiveElementChange:function(){if(document.activeElement&&!fb_editor.dismissActiveTrigger){var a=document.activeElement;fb_panel.inputFocused="";if(a.tagName!="SELECT"&&a.type!="checkbox"){$(a).trigger("change")}}fb_editor.dismissActiveTrigger=false},nextSelectedItem:function(a){if(a!=null){$(a).trigger("mousedown")}else{$("#elements").trigger("click");$("#control_properties_set").append('<p id="properties_placeholder">Select an element and its editable properties will appear here.</p>')}},itemToSelectable:function(){if($("#formproperties").hasClass("current")&&$(this).hasClass("fb-item")){fb_views.form()}fb_panel.show($(this));var c=$(this).offset().top;var b=$("#layout-center");if(c<0){if($(this).get(0)==$(this).parent().children(0).get(0)){$("#layout-center").scrollTop(0)}else{$("#layout-center").scrollTop($("#layout-center").scrollTop()+c)}}else{if(c+$(this).outerHeight(true)>$("#layout-center").outerHeight(true)){if($(this).attr("id")=="fb-submit-button-div"){var a=0;$("#layout-center").children().each(function(){a=$(this).outerHeight()});$("#layout-center").scrollTop(a)}else{$("#layout-center").scrollTop(c-$("#layout-center").height()+$("#layout-center").scrollTop()+$(this).outerHeight()+20)}}}},isSelectedItem:function(){if((fb_container.itemSelected)&&($(fb_container.itemSelected).attr("id")!="fb-submit-button-div")&&!($(fb_container.itemSelected).hasClass("fb-form-header"))){return true}else{return false}},isTextSelected:function(){if(window.getSelection){if(window.getSelection().toString()){return"YES"}else{return"NO"}}else{if(document.selection){var a=document.selection.createRange();if(a.text){return"YES"}else{return"NO"}}}},sendInsertAlert:function(f,e){var c={};var d=document.getElementById("item"+fb_toolbox.itemsCounter);var b=$("#item"+fb_toolbox.itemsCounter).prev();var a="";c.type_operation="insert";c.markup=fb_utils.getouterHtml(d);c.id_father=$("#item"+fb_toolbox.itemsCounter).parent().attr("id");if(b[0]){c.id_previous_brother=b[0].id}if(e){c.validation_object_id=e;c.validation_object=pValidationConfig.get_config_id(e)}appVar.pushUndo_(fb_editor.JSONParser.stringify(c))},resetStyles:function(){var b=document.getElementById("docContainer");var a=fb_undo.getFormParams(b);a.validation_object_id="fb-submit-button";a.validation_object=fb_utils.cloneObject(pValidationConfig.get_config_id("fb-submit-button"));var f=$("#control_toolbar .current");var e=new Array();$.each($(".fb-image").parent(),function(h,g){var i={id:g.id,style:"width:"+$(g).css("width")+";height:"+$(g).css("height")+";"};e.push(i)});$("#docContainer").removeAttr("style");$("#docContainer .column *").removeAttr("style");$("#docContainer #fb-submit-button").removeAttr("style");$("#docContainer").removeAttr("data-margin");$("#docContainer").removeClass("fb-small");$("#docContainer").removeClass("fb-large");$("#docContainer .fb-item-alignment-center").removeClass("fb-item-alignment-center");$("#docContainer .fb-item-alignment-left").removeClass("fb-item-alignment-left");$("#docContainer .fb-item-alignment-right").removeClass("fb-item-alignment-right");$("#docContainer .fb-one-column").removeClass("fb-one-column").addClass("fb-two-column");$("#docContainer .fb-three-column").removeClass("fb-three-column").addClass("fb-two-column");$("#docContainer").removeClass("fb-toplabel");$("#docContainer").removeClass("fb-leftlabel");$("#docContainer").removeClass("fb-rightlabel");fb_editor.resetSubmitStyles();$("#fb-submit-button").addClass("fb-submit-design");$("#fb-submit-button-div").removeAttr("style");var c=$("#fb-form-header1").css("min-height");$("#fb-form-header1").removeAttr("style");$("#fb-form-header1").css("min-height",c);$.each(e,function(h,g){$("#"+g.id).attr("style",g.style)});a.markupredo=fb_utils.getouterHtml(b);a.validation_object_redo=fb_utils.cloneObject(pValidationConfig.get_config_id("fb-submit-button"));var d=fb_editor.JSONParser.stringify(a);appVar.pushUndo_(d);$("#"+f[0].id).trigger("click")},resetSubmitStyles:function(){$("#fb-submit-button-div").css("min-height","");var a=document.getElementById("fb-submit-button");a.removeAttribute("style");a.removeAttribute("data-valign");$("#fb-submit-button-div").removeClass("fb-item-alignment-center");$("#fb-submit-button-div").removeClass("fb-item-alignment-left");$("#fb-submit-button-div").removeClass("fb-item-alignment-right");$("#fb-submit-button").removeClass("non-standard");$("#fb-submit-button").removeClass("fb-submit-design");pValidationConfig.set_config_subtype("fb-submit-button","hover","background-image","");fb_panel.applyBackgroundHover("fb-submit-button");$("#objectproperties").trigger("click")},initPlaceholderFallback:function(c){var b="placeholder" in document.createElement("input");var a="placeholder" in document.createElement("textarea");if(c==undefined){if(!b){$("#docContainer input[type=text], #docContainer input[type=email], #docContainer input[type=url], #docContainer input[type=tel]").placeholder();if(appVar.platform()!="win"){$("#docContainer input[type=password]").placeholder()}}if(!a){$("#docContainer textarea").placeholder()}}else{b=b&&$(c).get(0).tagName.toLowerCase()=="input";a=a&&$(c).get(0).tagName.toLowerCase()=="textarea";if(!b){$(c).placeholder()}if(!a){$(c).placeholder()}}}};window.onload=fb_editor.initEvents;var fb_clipboard={doCopy:function(){if(fb_panel.inputFocused){if(window.getSelection){return""}else{if(document.selection){var d=document.selection.createRange();if(d.text){return d.text}else{return""}}}}else{if(fb_editor.isSelectedItem()){var a={};var e="";if(fb_container.itemSelected[0].childNodes[1]){if($(fb_container.itemSelected[0].childNodes[1]).hasClass("fb-radio")||$(fb_container.itemSelected[0].childNodes[1]).hasClass("fb-checkbox")){e=fb_container.itemSelected[0].childNodes[1].firstChild.firstChild.id;if($(fb_container.itemSelected[0].childNodes[1]).hasClass("fb-radio")){for(var b=0;b<fb_container.itemSelected[0].childNodes[1].childNodes.length;b++){if(fb_container.itemSelected[0].childNodes[1].childNodes[b].firstChild.checked){a.radiochecked_id=fb_container.itemSelected[0].childNodes[1].childNodes[b].firstChild.id}}}}else{e=fb_container.itemSelected[0].childNodes[1].firstChild.id}}a.source="item";a.markup=fb_utils.getouterHtml(fb_container.itemSelected[0],true);a.validation_object=pValidationConfig.get_config_id(e);a.payments_object=pPaymentsConfig.get_config_id(e);var c=fb_editor.JSONParser.stringify(a);return c}}return""},doCut:function(){if(fb_panel.inputFocused){if(window.getSelection){return""}else{if(document.selection){var f=document.selection.createRange();if(f.text){return f.text}else{return""}}}}else{if(fb_editor.isSelectedItem()){var h="";if(fb_container.itemSelected[0].childNodes[1]){if($(fb_container.itemSelected[0].childNodes[1]).hasClass("fb-radio")||$(fb_container.itemSelected[0].childNodes[1]).hasClass("fb-checkbox")){h=fb_container.itemSelected[0].childNodes[1].firstChild.firstChild.id}else{h=fb_container.itemSelected[0].childNodes[1].firstChild.id}}var b={};b.source="item";b.markup=fb_utils.getouterHtml(fb_container.itemSelected[0]);b.validation_object=pValidationConfig.get_config_id(h);b.payments_object=pPaymentsConfig.get_config_id(h);b.validation_object_id=h;var e=fb_editor.JSONParser.stringify(b);var d={};d.type_operation="delete";d.markup=fb_utils.getouterHtml(fb_container.itemSelected[0]);d.validation_object=pValidationConfig.get_config_id(h);d.payments_object=pPaymentsConfig.get_config_id(h);d.validation_object_id=h;var c=$(fb_container.itemSelected).parent()[0];d.id_father=c.id;d.id_element=$(fb_container.itemSelected).attr("id");var a="";if($(fb_container.itemSelected).prev()[0]){a=$($(fb_container.itemSelected).prev()[0]).attr("id")}d.id_previous_brother=a;var g=fb_editor.JSONParser.stringify(d);$(fb_container.itemSelected).remove();pValidationConfig.remove_config_id(h);pPaymentsConfig.remove_config_id(h);fb_panel.clear();fb_container.itemSelected="";appVar.pushUndo_(g);fb_panel.updateAutofocus();return e}}return""},doPaste:function(a){var f={};var c=/"source":/;if(c.test(a)){f=fb_editor.JSONParser.parse(a);if(fb_editor.isSelectedItem()){$(fb_container.itemSelected).after(f.markup);$(fb_container.itemSelected).next().attr("id","item"+ ++fb_toolbox.itemsCounter)}else{$("#column1").append(f.markup);var b=$("#column1").children().length;$($("#column1").children()[b-1]).attr("id","item"+ ++fb_toolbox.itemsCounter)}$("#item"+fb_toolbox.itemsCounter).mousedown(fb_editor.itemToSelectable);var e=document.getElementById("item"+fb_toolbox.itemsCounter);if(e){var d="";if(f.validation_object_id){d=f.validation_object_id;pValidationConfig.set_config_id(f.validation_object_id,f.validation_object);pPaymentsConfig.set_config_id(f.validation_object_id,f.payments_object)}else{d=fb_toolbox.generateIds(e);if(d){fb_toolbox.generateNames(e);pValidationConfig.set_config_id(d,f.validation_object);pPaymentsConfig.set_config_id(d,f.payments_object);fb_panel.updateVerifyAttrs(e,f)}if(f.radiochecked_id&&document.getElementById(f.radiochecked_id)){$("#"+f.radiochecked_id).attr("checked",true)}}fb_panel.updateAutofocus()}fb_editor.sendInsertAlert(fb_toolbox.itemsCounter,d);fb_editor.initPlaceholderFallback($("#item"+fb_toolbox.itemsCounter+" input, #item"+fb_toolbox.itemsCounter+" textarea").get(0));$("#item"+fb_toolbox.itemsCounter).trigger("mousedown");if($("#workflow_switcher").attr("checked")){$("#objectproperties").trigger("click")}return"YES"}else{return"NO"}},doDelete:function(){if(fb_panel.inputFocused){return"NO"}else{if(fb_editor.isSelectedItem()){var g="";var b="";if(fb_container.itemSelected[0].childNodes[1]){if($(fb_container.itemSelected[0].childNodes[1]).hasClass("fb-radio")||$(fb_container.itemSelected[0].childNodes[1]).hasClass("fb-checkbox")){g=fb_container.itemSelected[0].childNodes[1].firstChild.firstChild.id;b=fb_container.itemSelected[0].childNodes[1].firstChild.firstChild.name}else{g=fb_container.itemSelected[0].childNodes[1].firstChild.id;b=fb_container.itemSelected[0].childNodes[1].firstChild.name}}if(b){if(b.substr(b.length-2,b.length)=="[]"){b=b.substr(0,b.length-2)}var f="["+b+"]";appVar.updateNameInSettings_(f)}var d={};d.type_operation="delete";d.markup=fb_utils.getouterHtml(fb_container.itemSelected[0]);d.validation_object=pValidationConfig.get_config_id(g);d.payments_object=pPaymentsConfig.get_config_id(g);d.validation_object_id=g;var c=$(fb_container.itemSelected).parent()[0];d.id_father=c.id;d.id_element=$(fb_container.itemSelected).attr("id");var a="";if($(fb_container.itemSelected).prev()[0]){a=$($(fb_container.itemSelected).prev()[0]).attr("id")}d.id_previous_brother=a;var e=fb_editor.JSONParser.stringify(d);var h=null;if(fb_container.itemSelected[0].nextSibling){h=fb_container.itemSelected[0].nextSibling}else{if(fb_container.itemSelected[0].previousSibling){h=fb_container.itemSelected[0].previousSibling}}$(fb_container.itemSelected).remove();pValidationConfig.remove_config_id(g);pPaymentsConfig.remove_config_id(g);fb_panel.clear();fb_container.itemSelected="";fb_editor.nextSelectedItem(h);appVar.pushUndo_(e);fb_panel.updateAutofocus();return"YES"}}return"NO"}};var fb_undo={actionMap:[],isInsertAction:false,map:function(a,b){this.actionMap[a]=b},init:function(){fb_undo.map("insert",fb_undo.insertAction);fb_undo.map("delete",fb_undo.deleteAction);fb_undo.map("move",fb_undo.moveAction);fb_undo.map("change",fb_undo.changeAction)},doAction:function(a){new this.actionMap[a.type_operation](a)},insertAction:function(b){if(b.id_previous_brother){var c=document.getElementById(b.id_previous_brother);var a=c.nextSibling;$(a).remove();fb_panel.clear()}else{$($("#"+b.id_father).children()[0]).remove();fb_panel.clear()}if(b.validation_object_id){pValidationConfig.remove_config_id(b.validation_object_id);pPaymentsConfig.remove_config_id(b.validation_object_id)}fb_container.itemSelected="";fb_panel.addLegendToPanel("");$("#control_properties_set").append('<p id="properties_placeholder">Select an element and its editable properties will appear here.</p>')},deleteAction:function(b){if(b.id_previous_brother){if($("#"+b.id_previous_brother).hasClass("section")){if($("#"+b.id_previous_brother).next().attr("id")==b.id_element){$("#"+b.id_previous_brother).next().remove()}$("#"+b.id_previous_brother).after(b.markup);var a=$("#"+b.id_previous_brother).next().children();fb_editor.initSectionChildren(a)}else{$("#"+b.id_previous_brother).after(b.markup);$("#"+b.id_previous_brother).next().mousedown(fb_editor.itemToSelectable);if(b.validation_object_id){if(b.validation_object){pValidationConfig.set_config_id(b.validation_object_id,b.validation_object)}if(b.payments_object){pPaymentsConfig.set_config_id(b.validation_object_id,b.payments_object)}}if(b.id_element){fb_editor.initPlaceholderFallback($("#"+b.id_element+" input, #"+b.id_element+" textarea").get(0))}$($("#"+b.id_previous_brother).next()).trigger("mousedown")}}else{if($("#"+b.id_father).attr("id")=="docContainer"){if($($("#"+b.id_father).children()[0]).attr("id")==b.id_element){$($("#"+b.id_father).children()[0]).remove()}$("#"+b.id_father).prepend(b.markup);var a=$($("#"+b.id_father).children()[0]).children();fb_editor.initSectionChildren(a)}else{$("#"+b.id_father).prepend(b.markup);$($("#"+b.id_father).children()[0]).mousedown(fb_editor.itemToSelectable);if(b.validation_object_id){if(b.validation_object){pValidationConfig.set_config_id(b.validation_object_id,b.validation_object)}if(b.payments_object){pPaymentsConfig.set_config_id(b.validation_object_id,b.payments_object)}}if(b.id_element){fb_editor.initPlaceholderFallback($("#"+b.id_element+" input, #"+b.id_element+" textarea").get(0))}$($("#"+b.id_father).children()[0]).trigger("mousedown")}}},moveAction:function(f){var b={};var c=f.markup;b.id_previous_brother=f.id_newbrother;b.type_operation="insert";b.markup=c;b.id_father=f.id_father;b.id_element=f.id_element;b.id_previous_brother=f.id_newbrother;var e=fb_editor.JSONParser.stringify(b);fb_undo.doUndo(e);var a={};a.type_operation="delete";a.markup=c;a.id_father=f.id_father;a.id_element=f.id_element;a.id_previous_brother=f.id_previous_brother;var d=fb_editor.JSONParser.stringify(a);fb_undo.doUndo(d)},changeAction:function(c){if(c.id_previous_brother){if($("#"+c.id_previous_brother).hasClass("fb-captcha")){$("#"+c.id_previous_brother).next().remove();$("#"+c.id_previous_brother).after(c.markup);if(c.validation_object_id){pValidationConfig.set_config_id(c.validation_object_id,c.validation_object)}fb_panel.applyBackgroundHover($("#"+c.id_element).children().get(0).id);var b=$("#"+c.id_previous_brother).next().children();fb_editor.initSectionChildren(b);$("#"+c.id_element).trigger("mousedown")}else{var a=document.getElementById(c.id_previous_brother).nextSibling;$(a).remove();$("#"+c.id_previous_brother).after(c.markup);$($("#"+c.id_previous_brother).next()).mousedown(fb_editor.itemToSelectable);if(c.validation_object_id){if(c.validation_object){pValidationConfig.set_config_id(c.validation_object_id,c.validation_object)}if(c.payments_object){pPaymentsConfig.set_config_id(c.validation_object_id,c.payments_object)}}if(c.id_element){fb_editor.initPlaceholderFallback($("#"+c.id_element+" input, #"+c.id_element+" textarea").get(0))}$($("#"+c.id_previous_brother).next()).trigger("mousedown")}}else{$($("#"+c.id_father).children()[0]).remove();if($("#"+c.id_father).children()[0]){$($("#"+c.id_father).children()[0]).before(c.markup)}else{$("#"+c.id_father).append(c.markup)}if($($("#"+c.id_father).children()[0]).attr("id")=="docContainer"){fb_container.initLoaded();if(c.validation_object_id){if(c.validation_object){pValidationConfig.set_config_id(c.validation_object_id,c.validation_object)}if(c.payments_object){pPaymentsConfig.set_config_id(c.validation_object_id,c.payments_object)}}fb_views.form();itColumn1=document.getElementById("column1");fb_container.itemSelected=itColumn1.lastChild;if(fb_editor.isSelectedItem()){$(fb_container.itemSelected).addClass("selected-object");document.getElementById("docContainer").style.webkitTransform="scale(1)";$("#docContainer").css("-webkit-transform","")}}else{if($($("#"+c.id_father).children()[0]).hasClass("section")){var b=$($("#docContainer").children()[0]).children();fb_editor.initSectionChildren(b)}else{$($("#"+c.id_father).children()[0]).mousedown(fb_editor.itemToSelectable);if(c.validation_object_id){if(c.validation_object){pValidationConfig.set_config_id(c.validation_object_id,c.validation_object)}if(c.payments_object){pPaymentsConfig.set_config_id(c.validation_object_id,c.payments_object)}}if(c.id_element){fb_editor.initPlaceholderFallback($("#"+c.id_element+" input, #"+c.id_element+" textarea").get(0))}$($("#"+c.id_father).children()[0]).trigger("mousedown")}}}},doUndo:function(a){fb_editor.dismissActiveTrigger=true;var b=fb_editor.JSONParser.parse(a);$(".fb-item").removeClass("selected-object");$("#fb-submit-button-div").removeClass("selected-object");fb_undo.doAction(b);if($("#formproperties").hasClass("current")){fb_panel.updateAutofocus()}$("#docContainer a").live("click",function(c){c.preventDefault();return false})},doRedo:function(a){$("#fb-submit-button-div").removeClass("selected-object");var c=fb_editor.JSONParser.parse(a);var b;if(c.type_operation=="insert"){c.type_operation="delete";b=fb_editor.JSONParser.stringify(c);fb_undo.doUndo(b)}else{if(c.type_operation=="delete"){c.type_operation="insert";b=fb_editor.JSONParser.stringify(c);fb_undo.doUndo(b)}else{if(c.type_operation=="move"){c.type_operation="insert";b=fb_editor.JSONParser.stringify(c);fb_undo.doUndo(b);c.type_operation="delete";c.id_previous_brother=c.id_newbrother;b=fb_editor.JSONParser.stringify(c);fb_undo.doUndo(b)}else{if(c.type_operation=="change"){c.markup=c.markupredo;c.validation_object=c.validation_object_redo;c.payments_object=c.payments_object_redo;b=fb_editor.JSONParser.stringify(c);fb_undo.doUndo(b)}}}}},getItemParams:function(e,d){var b={};var c=d?true:false;var a="";if($(e).parent().prev()[0]){a=$($(e).parent().prev()[0]).attr("id")}b.type_operation="change";b.markup=fb_utils.getouterHtml($(e).parent()[0],c);b.id_father=$(e).parent().parent()[0].id;b.id_previous_brother=a;b.id_element=$(e).parent()[0].id;return b},getFormParams:function(b){var a={};a.type_operation="change";a.markup=fb_utils.getouterHtml(b);a.id_father=$(b).parent()[0].id;a.id_previous_brother="";a.id_element="docContainer";return a},getSubmitParams:function(b){var a={};a.type_operation="change";a.markup=fb_utils.getouterHtml(b);a.id_father="docContainer";a.id_previous_brother="fb-captcha_control";a.id_element="fb-submit-button-div";return a},getLogoAndHeaderParams:function(b){var a={};a.type_operation="change";a.markup=fb_utils.getouterHtml(b);a.id_father="docContainer";a.id_previous_brother="";a.id_element="fb-form-header1";return a}};